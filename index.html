<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rhythm Chart Editor</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div id="sidebar">
    <div class="sidebar-controls" style="padding: 8px;">
      <label>BPM: <input id="bpm" type="number" value="120" min="60" max="300" step="1" /></label>
      <br><br>
      <label>Pre-delay (ms): <input id="pre-delay" type="number" value="3000" min="-10000" max="10000" step="100" /></label>
      <br><br>
      <label>Level: <input id="level" type="range" value="10" min="1" max="20" step="1" oninput="document.getElementById('level-display').textContent = this.value" /></label>
      <span id="level-display" style="margin-left: 5px;">10</span>
      <br><br>
      <label>Subdivisions:
        <select id="subdivisions">
          <option value="2">2Î∂ÑÎ∞ï</option>
          <option value="4">4Î∂ÑÎ∞ï</option>
          <option value="8">8Î∂ÑÎ∞ï</option>
          <option value="12">12Î∂ÑÎ∞ï</option>
          <option value="16" selected>16Î∂ÑÎ∞ï</option>
          <option value="24">24Î∂ÑÎ∞ï</option>
          <option value="32">32Î∂ÑÎ∞ï</option>
          <option value="48">48Î∂ÑÎ∞ï</option>
        </select>
      </label>
      <br><br>
      <label><input type="checkbox" id="batch-edit-toggle"> ÎÖ∏Ìä∏ ÏùºÍ¥Ñ ÏàòÏ†ï</label>
    </div>

    <!-- ÌÉ≠ Ìó§Îçî -->
    <div class="tab-header">
      <button class="tab-button active" data-tab="notes">NoteList</button>
      <button class="tab-button" data-tab="events">EventList</button>
    </div>

    <!-- ÎÖ∏Ìä∏ Î¶¨Ïä§Ìä∏ ÌÉ≠ -->
    <div id="notes-tab" class="tab-content active">
      <div style="padding: 8px; border-bottom: 1px solid #555; background: #2a2a2a; display: flex; gap: 8px;">
        <button id="duplicate-notes" style="background: #2196F3; color: white; border: none; padding: 4px 10px; cursor: pointer; border-radius: 3px; font-size: 11px;">üìã Î≥µÏ†ú</button>
        <button id="clear-note-selection" style="background: #607D8B; color: white; border: none; padding: 4px 10px; cursor: pointer; border-radius: 3px; font-size: 11px;">‚úñ ÏÑ†ÌÉù Ìï¥Ï†ú</button>
      </div>
      <table>
        <thead>
          <tr>
            <th>NO.</th>
            <th>Type</th>
            <th>Beat</th>
            <th>Time</th>
            <th>Length</th>
            <th>Direction</th>
            <th>BPM</th>
            <th>Sub</th>
            <th>Wait</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="note-list">
          <!-- script.jsÍ∞Ä Ïó¨Í∏∞ <tr>ÏùÑ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÌï® -->
        </tbody>
      </table>
    </div>

    <!-- Ïù¥Î≤§Ìä∏ Î¶¨Ïä§Ìä∏ ÌÉ≠ -->
    <div id="events-tab" class="tab-content">
      <div class="event-controls">
        <div class="event-controls-left">
          <button id="add-event">+ Add Event</button>
          <button id="duplicate-events">üìã Î≥µÏ†ú</button>
          <button id="clear-event-selection">‚úñ ÏÑ†ÌÉù Ìï¥Ï†ú</button>
          <button id="collapse-all">Î™®Îëê Ï†ëÍ∏∞</button>
          <button id="expand-all">Î™®Îëê ÌéºÏπòÍ∏∞</button>
        </div>
        <div class="event-controls-right">
          <button id="go-to-url">üåê Ïù¥Î≤§Ìä∏ Î©îÎâ¥Ïñº</button>
        </div>
      </div>
      <div id="event-list" class="event-list-container">
        <!-- script.jsÍ∞Ä Ïó¨Í∏∞Ïóê Ïù¥Î≤§Ìä∏Îì§ÏùÑ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÌï® -->
      </div>
    </div>
  </div>

  <!-- ÏÇ¨Ïù¥ÎìúÎ∞î ÌÜ†Í∏Ä Î≤ÑÌäº (ÏÇ¨Ïù¥ÎìúÎ∞î Î∞ñÏóê ÏúÑÏπò) -->
  <button id="sidebar-toggle" class="toggle-btn sidebar-toggle">‚óÄ</button>

  <div id="main">
    <div id="top-bar">
      <button id="save-json">Save Json</button>
      <button id="load-json">Load Json</button>
      <button id="sort-notes">Sort by Time</button>
      <button id="clear-notes">Clear All</button>
      <button id="undo-btn" title="Ïã§Ìñâ Ï∑®ÏÜå (Ctrl+Z)" disabled>‚Ü∂ Ïã§Ìñâ Ï∑®ÏÜå</button>
      <button id="redo-btn" title="Îã§Ïãú Ïã§Ìñâ (Ctrl+Y)" disabled>‚Ü∑ Îã§Ïãú Ïã§Ìñâ</button>
      <div id="volume-controls">
        <div style="display: flex; flex-direction: column; gap: 5px; align-items: center;">
          <div style="display: flex; align-items: center; gap: 8px;">
            <label style="font-size: 11px; min-width: 50px;">ÏùåÏïÖ:</label>
            <input type="range" id="music-volume" min="0" max="100" value="50" step="1" style="width: 100px;">
            <span id="music-volume-display" style="font-size: 11px; min-width: 30px;">50%</span>
          </div>
          <div style="display: flex; align-items: center; gap: 8px;">
            <label style="font-size: 11px; min-width: 50px;">Ìö®Í≥ºÏùå:</label>
            <input type="range" id="sfx-volume" min="0" max="100" value="100" step="1" style="width: 100px;">
            <span id="sfx-volume-display" style="font-size: 11px; min-width: 30px;">100%</span>
          </div>
        </div>
      </div>
    </div>

    <canvas id="canvas"></canvas>
  </div>

  <!-- Ïö∞ÌïòÎã® ÌîåÎ°úÌåÖ Ïª®Ìä∏Î°§ Ìå®ÎÑê -->
  <div id="control-bar">
    <div id="control-bar-content">
      <div id="audio-controls">
        <input type="file" id="audio-file" accept="audio/*">
        <div id="playback-controls">
          <button id="demo-pause">‚è∏</button>
          <button id="demo-play">‚ñ∂</button>
          <button id="demo-stop">‚èπ</button>
        </div>
      </div>

      <div id="time-controls">
        <div id="demo-time">00:00:00 / 00:00:00</div>
        <input type="range" id="demo-seekbar" value="0" min="0" max="1000" step="1">
      </div>

      <div id="note-controls">
        <div class="note-controls-row">
          <button class="tab" id="add-tab">Tab +</button>
          <button class="dir" id="add-dir">Direction +</button>
          <button class="both" id="add-both">Both +</button>
          <button class="node" id="add-node">Node +</button>
        </div>
        <div class="note-controls-row">
          <button class="long-tab" id="add-long-tab">Long Tab +</button>
          <button class="long-dir" id="add-long-dir">Long Direction +</button>
          <button class="long-both" id="add-long-both">Long Both +</button>
        </div>
      </div>
      <div class="controls">
        <label for="camera-tracking">Ïπ¥Î©îÎùº Ï∂îÏ†Å</label>
        <input type="checkbox" id="camera-tracking" checked>
        <br>
        <label for="realtime-drawing">Ïã§ÏãúÍ∞Ñ Í∑∏Î¶¨Í∏∞</label>
        <input type="checkbox" id="realtime-drawing" checked>
        <br>
        <label for="draw-ahead-time">Í∑∏Î¶¨Í∏∞ ÏãúÍ∞ÑÏ∞®(Ï¥à):</label>
        <input type="number" id="draw-ahead-time" value="2" min="0.1" max="10" step="0.1" style="width: 60px;">
      </div>
    </div>
  </div>

  <!-- Ïª®Ìä∏Î°§Î∞î ÌÜ†Í∏Ä Î≤ÑÌäº (Ïª®Ìä∏Î°§Î∞î Î∞ñÏóê ÏúÑÏπò) -->
  <button id="control-bar-toggle" class="toggle-btn control-bar-toggle">√ó</button>

  <!-- ÏùåÌñ• Í∑∏ÎûòÌîÑ ÌîåÎ°úÌåÖ ÏòÅÏó≠ -->
  <div id="waveform-container">
    <div id="waveform-controls">
      <button id="waveform-zoom-in">+</button>
      <button id="waveform-zoom-out">-</button>
      <button id="waveform-reset">Reset</button>
      <span id="waveform-zoom-level">100%</span>
    </div>
    <div id="waveform-wrapper">
      <canvas id="waveform-canvas"></canvas>
      <div id="waveform-progress"></div>
      <canvas id="ruler-canvas"></canvas>
    </div>
    <div id="waveform-scrollbar">
      <input type="range" id="waveform-slider" min="0" max="100" value="0" step="1">
    </div>
  </div>

  <!-- ÎßàÏö∞Ïä§ Ìä∏Î¶¨Í±∞ ÏòÅÏó≠ -->
  <div class="waveform-trigger-zone"></div>

  <script src="audio-sync-module.js"></script>
  <script type="module" src="script.js"></script>
</body>

</html>